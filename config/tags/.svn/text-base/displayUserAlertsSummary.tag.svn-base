<%@ tag import="java.io.*,java.util.*,org.mitre.mrald.taglib.*,org.mitre.mrald.util.*,java.sql.*" %>
<%
    //String user = WebUtils.getOptionalParameter(request, "user", "ghamilton" );
    String person_id = WebUtils.getOptionalParameter(request, "person_id", "0" );
    System.out.println("displayUserAlertsSummary person_id " + person_id); 
    int user_id = Integer.parseInt(person_id);
    
    String query = 
    "select  profile_id,user_name, first_name, last_name, by_email, by_fax, by_telephone, by_mobile_phone, by_voice_message, profile_name "
	+" from user_profile, saife_user where saife_user.user_id = user_profile.saife_user_user_id and saife_user.user_id = ? ";
    Connection conn = new MraldConnection("main").getConnection();
    PreparedStatement prep = conn.prepareStatement(query);
	prep.setInt(1, user_id);
	
    StringBuffer logInfo = new StringBuffer();
    long startTime = MiscUtils.logQuery("displayUserAlertsSummary.tag", "main", query, logInfo);
    ResultSet rs =prep.executeQuery();
    
    MiscUtils.logQueryRun(startTime, logInfo);
    %>
    <style type="text/css"> 
        .RED { color:red; } 
        .GREEN { color:darkgreen; } 
        .YELLOW { color:orange; } 
    </style>
   
    <%    	
    while (rs.next())
    {
    	String profile_name = rs.getString("profile_name");
    	int profileId = rs.getInt("profile_id");
    	
         %>
       
    	 <div class="wide_table_top">
					<div align="center">
					<span class="title_panel"><%=profile_name%>
					 &nbsp<input type="button" value ="+" onclick="$('#profileDetails<%=profileId%>').load('profileDetail.jsp?profile_id=<%=profileId%>&person_id=<%=person_id%>')"></input>
					 
					</span> 
					</div>
					
		 </div>
		 
    	 <div class="wide_table_content">
					<div class="wide_table_text">
					
					
					<div id="profileDetails<%=profileId%>">
		 
					</div>
		<br/>
		</div>
		</div>
        <%	
    }
    
    rs.close();
    conn.close();
%>